<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TESTE - LANDING - RÁDIO</title>
    <link rel="stylesheet" href="./src/styles/dropdown_mobile.css" />
    <link rel="stylesheet" href="./src/styles/ads_content.css" />
    <link rel="stylesheet" href="./src/styles/footer.css" />
    <link rel="stylesheet" href="./src/styles/player.css" />
    <link rel="stylesheet" href="./src/styles/vars.css" />
    <link rel="stylesheet" href="./src/styles/reset.css" />
    <link rel="stylesheet" href="./src/styles/style.css" />
    <!-- LINK CSS ICONS -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body>
    <div id="header"></div>
    <div class="page-background">
      <!--  -->
      <div class="page-content">
        <main>
          <div class="word-of-the-day">
            <span id="phrase">palavra do dia:</span>
            <span id="text"><q id="frase"></q></span>
            <a
              target="_blank"
              class="word"
              href="https://wa.me/5511976916597?text=Ola!!Gostaria de uma palavra."
              ><button type="button">pedir uma palavra</button></a
            >
          </div>
          <!--  -->
          <section style="margin-top: 200px" class="main--video">
            <div class="ads-phrase">
              <span>assista a nossas lives!</span>
              <p>
                Fique por dentro dos conteúdos que nós produzimos, basta
                assistir aos conteúdos do player ao lado
                <img
                  width="30px"
                  style="transform: translateY(7px)"
                  src="./src/assets/EMOJI.png"
                  alt="EMOJI DE UMA MÃO APONTANDO PARA O LADO DIREITO"
                />
              </p>
            </div>
            <!--  -->
            <div class="ads-player">
              <iframe
                src="https://player.rbstream.com.br/video/radioc16/1/true/false/WkVoWmRXTnRTbnBrU0Vwc1dWY3dkVmt5T1hSTWJVcDUrMw==/16:9/"
                scrolling="yes"
                frameborder="0"
                allowfullscreen
              ></iframe>
            </div>
          </section>
          <!--  -->
          <div class="main-pix">
            <div class="qrcode--main">
              <img
                src="./src/assets/qrcode_feito.png"
                alt="qrcode com um pix para ajudar a rádio tempo de avivamento a se manter ativa."
              />
            </div>
            <!--  -->
            <div class="pix--text">
              <span>Ajude a manter nossa Rádio Online no ar! </span>
              <p>
                Sua contribuição é muito importante para continuarmos levando a
                Palavra de Deus a mais corações. Aponte a câmera do seu celular
                para o QR Code e faça um Pix com o valor que Deus tocar no seu
                coração.
              </p>
            </div>
          </div>
          <!--  -->
          <div class="ads">
            <div id="sections" class="ads">
              <div class="ads-content">
                <span
                  style="
                    color: #ffd000ef;
                    font-weight: 700;
                    font-size: 20px;
                    word-spacing: 5px;
                  "
                  >NOSSOS ANUNCIANTES:</span
                >
                <div class="ads-content__content">
                  <!--  -->
                  <div class="arrows">
                    <span id="arrow-left" class="fa-solid fa-arrow-left"></span>
                    <span
                      id="arrow-right"
                      class="fa-solid fa-arrow-right"
                    ></span>
                  </div>
                  <!--  -->
                  <div class="img-ads"><!--  --></div>
                </div>
                <!--  -->
              </div>
            </div>
          </div>
        </main>
        <!--  -->
        <div id="footer"></div>
      </div>
    </div>
    <!--  -->
    <div class="main__audio-player">
      <a
        class="answer"
        target="_blank"
        href="https://wa.me/5511976916597?text=Ola!!Gostaria de uma música."
      >
        <button>PEDIDO</button>
      </a>
      <div class="audio-player__content">
        <audio
          autoplay
          id="audio-stream"
          src="https://stm4.audio.rbstream.com.br:7162/stream"
        ></audio>
        <!--  -->
        <img id="album-cover" src="" alt="Capa do Álbum" />
        <div id="now-playing"></div>
        <div id="play-pause">&#9658;</div>
      </div>
    </div>
    <script src="./src/js/player.js"></script>
    <script type="module" src="./src/js/palavra.js"></script>
    <script>
      fetch("footer.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("footer").innerHTML = data;

          const yearElement = document.getElementById("year");
          if (yearElement) {
            yearElement.textContent = new Date().getFullYear();
          }
        });
      fetch("header.html")
        .then((response) => response.text())
        .then((data) => {
          document.getElementById("header").innerHTML = data;
        });
    </script>
    <script type="module">
      import { getGithubToken } from "./src/js/limao.js";

      const repoOwner = "victorlima-legendary";
      const repoName = "JSON_RADIO";
      const jsonFile = "ads.json";

      const container = document.querySelector(".img-ads");
      const arrowLeft = document.getElementById("arrow-left");
      const arrowRight = document.getElementById("arrow-right");

      let currentIndex = 0;
      let totalItems = 0;
      let scrollInterval;

      async function carregarAnuncios() {
        const githubToken = await getGithubToken();

        if (!githubToken) {
          console.error("Token inválido ou não carregado.");
          return;
        }

        try {
          const res = await fetch(
            `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${jsonFile}`,
            {
              headers: {
                Authorization: `Bearer ${githubToken}`,
              },
            }
          );

          const data = await res.json();
          const content = atob(data.content);
          const json = JSON.parse(content);

          const imagens = json.imagens || [];
          totalItems = imagens.length;

          imagens.forEach((img) => {
            const imgWrapper = document.createElement("div");
            imgWrapper.classList.add("img-ads__item");

            const el = document.createElement("img");
            el.src = img.link;
            el.alt = img.nome;

            imgWrapper.appendChild(el);
            container.appendChild(imgWrapper);
          });
        } catch (error) {
          console.error("Erro ao carregar imagens:", error);
        }
      }

      function scrollToIndex(index) {
        const width = container.clientWidth;
        container.scrollTo({ left: index * width, behavior: "smooth" });
      }

      function rolarAutomaticamente() {
        scrollInterval = setInterval(() => {
          currentIndex = (currentIndex + 1) % totalItems;
          scrollToIndex(currentIndex);
        }, 5000);
      }

      arrowLeft.addEventListener("click", () => {
        clearInterval(scrollInterval);
        currentIndex = (currentIndex - 1 + totalItems) % totalItems;
        scrollToIndex(currentIndex);
        rolarAutomaticamente();
      });

      arrowRight.addEventListener("click", () => {
        clearInterval(scrollInterval);
        currentIndex = (currentIndex + 1) % totalItems;
        scrollToIndex(currentIndex);
        rolarAutomaticamente();
      });

      carregarAnuncios().then(rolarAutomaticamente);
    </script>
  </body>
</html>
